<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Gamedev Canvas Workshop</title>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        canvas {
            background: black;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>

<body>

    <canvas id="Game" width="280" height="450"></canvas>

    <script>
        var HauteurPlateau = 100;
        var canvas = document.getElementById("Game");
        var ctx = canvas.getContext("2d");
        var x = 140;
        var y = HauteurPlateau + 235;
        var right = false;
        var left = false;
        var haut = false;
        var bas = false;
        var moveright = false;
        var moveleft = false;
        var movehaut = false;
        var movebas = false;
        var change = false;
        var life = 4;
        var score = 0;
        var highscore = 0;
        var ptsEat = 0;
        var lvl = 0;
        var fruit = false;
        var fantome = new Object()
        fantome.blinky = new Object()
        fantome.blinky.direction = "gauche";
        fantome.blinky.vitesse = 0.6;
        fantome.blinky.x = 140;
        fantome.blinky.y = 115;
        fantome.blinky.choix = false;
        fantome.blinky.couleur = "000000";
        fantome.pinky = new Object();
        fantome.pinky.direction = "gauche";
        fantome.pinky.vitesse = 0.6;
        fantome.pinky.x = 140;
        fantome.pinky.y = 115;
        fantome.pinky.choix = false;
        fantome.pinky.couleur = "000000";
        fantome.inky = new Object();
        fantome.inky.direction = "gauche";
        fantome.inky.vitesse = 0.6;
        fantome.inky.x = 120;
        fantome.inky.y = 115;
        fantome.inky.choix = false;
        fantome.inky.couleur = "000000";
        fantome.clyde = new Object();
        fantome.clyde.direction = "gauche";
        fantome.clyde.vitesse = 0.6;
        fantome.clyde.x = 160;
        fantome.clyde.y = 115;
        fantome.clyde.choix = false;
        fantome.clyde.couleur = "000000";


        var l =
            [["3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3"],
            ["3", "1", "1", "1", "1", "1", "4", "1", "1", "1", "1", "1", "1", "3", "3", "1", "1", "1", "1", "1", "1", "4", "1", "1", "1", "1", "1", "3"],
            ["3", "1", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
            ["3", "2", "3", "0", "0", "3", "1", "3", "0", "0", "0", "3", "1", "3", "3", "1", "3", "0", "0", "0", "3", "1", "3", "0", "0", "3", "2", "3"],
            ["3", "1", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
            ["3", "4", "1", "1", "1", "1", "4", "1", "1", "4", "1", "1", "4", "1", "1", "4", "1", "1", "4", "1", "1", "4", "1", "1", "1", "1", "4", "3"],
            ["3", "1", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
            ["3", "1", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
            ["3", "1", "1", "1", "1", "1", "4", "3", "3", "1", "1", "1", "1", "3", "3", "1", "1", "1", "1", "3", "3", "4", "1", "1", "1", "1", "1", "3"],
            ["3", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "0", "3", "3", "0", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "3"],
            ["0", "0", "0", "0", "0", "3", "1", "3", "3", "3", "3", "3", "0", "3", "3", "0", "3", "3", "3", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
            ["0", "0", "0", "0", "0", "3", "1", "3", "3", "0", "0", "0", "5", "0", "0", "5", "0", "0", "0", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
            ["0", "0", "0", "0", "0", "3", "1", "3", "3", "0", "3", "3", "3", "3", "3", "3", "3", "3", "0", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
            ["3", "3", "3", "3", "3", "3", "1", "3", "3", "0", "3", "0", "0", "0", "0", "0", "0", "3", "0", "3", "3", "1", "3", "3", "3", "3", "3", "3"],
            ["0", "0", "0", "0", "0", "0", "4", "0", "0", "5", "3", "0", "0", "0", "0", "0", "0", "3", "5", "0", "0", "4", "0", "0", "0", "0", "0", "0"],
            ["3", "3", "3", "3", "3", "3", "1", "3", "3", "0", "3", "0", "0", "0", "0", "0", "0", "3", "0", "3", "3", "1", "3", "3", "3", "3", "3", "3"],
            ["0", "0", "0", "0", "0", "3", "1", "3", "3", "0", "3", "3", "3", "3", "3", "3", "3", "3", "0", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
            ["0", "0", "0", "0", "0", "3", "1", "3", "3", "5", "0", "0", "0", "0", "0", "0", "0", "0", "5", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
            ["0", "0", "0", "0", "0", "3", "1", "3", "3", "0", "3", "3", "3", "3", "3", "3", "3", "3", "0", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
            ["3", "3", "3", "3", "3", "3", "1", "3", "3", "0", "3", "3", "3", "3", "3", "3", "3", "3", "0", "3", "3", "1", "3", "3", "3", "3", "3", "3"],
            ["3", "1", "1", "1", "1", "1", "4", "1", "1", "4", "1", "1", "1", "3", "3", "1", "1", "1", "4", "1", "1", "4", "1", "1", "1", "1", "1", "3"],
            ["3", "1", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
            ["3", "1", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
            ["3", "2", "1", "1", "3", "3", "4", "1", "1", "4", "1", "1", "4", "0", "0", "4", "1", "1", "4", "1", "1", "1", "3", "3", "1", "1", "2", "3"],
            ["3", "3", "3", "1", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "1", "3", "3", "3"],
            ["3", "3", "3", "1", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "1", "3", "3", "3"],
            ["3", "1", "1", "4", "1", "1", "1", "3", "3", "1", "1", "1", "1", "3", "3", "1", "1", "1", "1", "3", "3", "1", "1", "1", "4", "1", "1", "3"],
            ["3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3"],
            ["3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3"],
            ["3", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "4", "1", "1", "4", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "3"],
            ["3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3"]];


        var tab = [["3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3"],
        ["3", "1", "1", "1", "1", "1", "4", "1", "1", "1", "1", "1", "1", "3", "3", "1", "1", "1", "1", "1", "1", "4", "1", "1", "1", "1", "1", "3"],
        ["3", "1", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
        ["3", "2", "3", "0", "0", "3", "1", "3", "0", "0", "0", "3", "1", "3", "3", "1", "3", "0", "0", "0", "3", "1", "3", "0", "0", "3", "2", "3"],
        ["3", "1", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
        ["3", "4", "1", "1", "1", "1", "4", "1", "1", "4", "1", "1", "4", "1", "1", "4", "1", "1", "4", "1", "1", "4", "1", "1", "1", "1", "4", "3"],
        ["3", "1", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
        ["3", "1", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
        ["3", "1", "1", "1", "1", "1", "4", "3", "3", "1", "1", "1", "1", "3", "3", "1", "1", "1", "1", "3", "3", "4", "1", "1", "1", "1", "1", "3"],
        ["3", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "0", "3", "3", "0", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "3"],
        ["0", "0", "0", "0", "0", "3", "1", "3", "3", "3", "3", "3", "0", "3", "3", "0", "3", "3", "3", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
        ["0", "0", "0", "0", "0", "3", "1", "3", "3", "0", "0", "0", "5", "0", "0", "5", "0", "0", "0", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
        ["0", "0", "0", "0", "0", "3", "1", "3", "3", "0", "3", "3", "3", "3", "3", "3", "3", "3", "0", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
        ["3", "3", "3", "3", "3", "3", "1", "3", "3", "0", "3", "0", "0", "0", "0", "0", "0", "3", "0", "3", "3", "1", "3", "3", "3", "3", "3", "3"],
        ["0", "0", "0", "0", "0", "0", "4", "0", "0", "5", "3", "0", "0", "0", "0", "0", "0", "3", "5", "0", "0", "4", "0", "0", "0", "0", "0", "0"],
        ["3", "3", "3", "3", "3", "3", "1", "3", "3", "0", "3", "0", "0", "0", "0", "0", "0", "3", "0", "3", "3", "1", "3", "3", "3", "3", "3", "3"],
        ["0", "0", "0", "0", "0", "3", "1", "3", "3", "0", "3", "3", "3", "3", "3", "3", "3", "3", "0", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
        ["0", "0", "0", "0", "0", "3", "1", "3", "3", "5", "0", "0", "0", "0", "0", "0", "0", "0", "5", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
        ["0", "0", "0", "0", "0", "3", "1", "3", "3", "0", "3", "3", "3", "3", "3", "3", "3", "3", "0", "3", "3", "1", "3", "0", "0", "0", "0", "0"],
        ["3", "3", "3", "3", "3", "3", "1", "3", "3", "0", "3", "3", "3", "3", "3", "3", "3", "3", "0", "3", "3", "1", "3", "3", "3", "3", "3", "3"],
        ["3", "1", "1", "1", "1", "1", "4", "1", "1", "4", "1", "1", "1", "3", "3", "1", "1", "1", "4", "1", "1", "4", "1", "1", "1", "1", "1", "3"],
        ["3", "1", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
        ["3", "1", "3", "3", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "1", "3", "3", "3", "3", "1", "3"],
        ["3", "2", "1", "1", "3", "3", "4", "1", "1", "4", "1", "1", "4", "0", "0", "4", "1", "1", "4", "1", "1", "4", "3", "3", "1", "1", "2", "3"],
        ["3", "3", "3", "1", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "1", "3", "3", "3"],
        ["3", "3", "3", "1", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "1", "3", "3", "3"],
        ["3", "1", "1", "4", "1", "1", "1", "3", "3", "1", "1", "1", "1", "3", "3", "1", "1", "1", "1", "3", "3", "1", "1", "1", "4", "1", "1", "3"],
        ["3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3"],
        ["3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3", "3", "1", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "1", "3"],
        ["3", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "4", "1", "1", "4", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "3"],
        ["3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3"]];
        function drawPacman() {
            if (right) if (l[Math.floor((Math.round(y) - HauteurPlateau) / 10)][Math.floor((Math.round(x) + 5) / 10)] != "3" && Math.round(y) % 10 == 5) {

                x += 1;
                movebas = false;
                movehaut = false;
                moveleft = false;
                if (!moveright) {
                    moveright = true;
                    left = false;
                    haut = false;
                    bas = false;
                }
            }
            if (left) if (l[Math.floor((Math.round(y) - HauteurPlateau) / 10)][Math.floor((Math.round(x) - 6) / 10)] != "3" && Math.round(y) % 10 == 5) {

                x -= 1;
                movebas = false;
                movehaut = false;
                moveright = false;
                if (!moveleft) {
                    moveleft = true;
                    right = false;
                    haut = false;
                    bas = false;
                }
            }
            if (haut) if (l[Math.floor((Math.round(y) - 6 - HauteurPlateau) / 10)][Math.floor(Math.round(x) / 10)] != "3" && Math.round(x) % 10 == 5) {

                y -= 1;
                movebas = false;
                moveleft = false;
                moveright = false;
                if (!movehaut) {
                    movehaut = true;
                    right = false;
                    left = false;
                    bas = false;
                }
            }
            if (bas) if (l[Math.floor((Math.round(y) + 5 - HauteurPlateau) / 10)][Math.floor(Math.round(x) / 10)] != "3" && Math.round(x) % 10 == 5) {

                y += 1;
                movehaut = false;
                moveleft = false;
                moveright = false;
                if (!movebas) {
                    movebas = true;
                    right = false;
                    left = false;
                    haut = false;
                }
            }

            if (x < 0)
                x = 280;
            if (x > 280)
                x = 0;

            if (l[Math.floor((Math.round(y) - HauteurPlateau) / 10)][Math.floor(Math.round(x) / 10)] == "1") {
                score += 10;
                ptsEat += 10;
                console.log(ptsEat)
                if (ptsEat == 700 || ptsEat == 1700)
                    fruit = true;
                if (ptsEat == 2600)
                    nextLvl();
                l[Math.floor((Math.round(y) - HauteurPlateau) / 10)][Math.floor(Math.round(x) / 10)] = "0";
            }
            if (l[Math.floor((Math.round(y) - HauteurPlateau) / 10)][Math.floor(Math.round(x) / 10)] == "4") {
                score += 10;
                ptsEat += 10;
                console.log(ptsEat)
                if (ptsEat == 700 || ptsEat == 1700)
                    fruit = true;
                if (ptsEat == 2600)
                    nextLvl();
                l[Math.floor((Math.round(y) - HauteurPlateau) / 10)][Math.floor(Math.round(x) / 10)] = "5";
            }

            if (l[Math.floor((Math.round(y) - HauteurPlateau) / 10)][Math.floor(Math.round(x) / 10)] == "2") {
                score += 50;
                ptsEat += 50;
                console.log(ptsEat)
                if (ptsEat == 700 || ptsEat == 1700)
                    fruit = true;
                console.log(ptsEat)
                if (ptsEat == 2600)
                    nextLvl();
                l[Math.floor((y - HauteurPlateau) / 10)][Math.floor(x / 10)] = "0";
            }
            if (fruit && Math.round(y) == HauteurPlateau + 175 && Math.round(x) == 140) {
                fruit = false;
                score += 100;
            }

            ctx.beginPath();
            ctx.arc(x, y, 7, 0, Math.PI * 2);
            ctx.fillStyle = "#FFFF00";
            ctx.fill();
            ctx.closePath();
        }
        function drawMap() {
            for (var i = 0; i < 28; i++) {
                for (var j = 0; j < 31; j++) {
                    switch (l[j][i]) {
                        case '0':
                            break;
                        case '1': ctx.beginPath();
                            ctx.arc(i * 10 + 5, j * 10 + 5 + HauteurPlateau, 2, 0, Math.PI * 2);
                            ctx.fillStyle = "#FFFF00";
                            ctx.fill();
                            ctx.closePath();
                            break;
                        case '2': ctx.beginPath();
                            ctx.arc(i * 10 + 5, j * 10 + 5 + HauteurPlateau, 4, 0, Math.PI * 2);
                            ctx.fillStyle = "#f6f6f6";
                            ctx.fill();
                            ctx.closePath();
                            break;
                        case '3': ctx.beginPath();
                            ctx.rect(i * 10 + 2.5, j * 10 + 2.5 + HauteurPlateau, 5, 5); ctx.fillStyle = "#0002ff";
                            ctx.fill();
                            ctx.closePath();
                            break;
                        case '4': ctx.beginPath();
                            ctx.arc(i * 10 + 5, j * 10 + 5 + HauteurPlateau, 2, 0, Math.PI * 2);
                            ctx.fillStyle = "#FFFF00";
                            ctx.fill();
                            ctx.closePath();
                            break;
                    }

                }
            }

        }
        function drawinfo() {
            ctx.font = "16px Arial";
            ctx.fillStyle = "#FFFFFF";
            ctx.textAlign = "center";
            ctx.fillText(score, 50, HauteurPlateau - 10);
            ctx.fillText(highscore, 280 / 2, HauteurPlateau - 30);
            ctx.fillText("HIGH SCORE", 280 / 2, HauteurPlateau - 50);
        }

        function nextLvl() {
            console.log("nexttttttttttttt")
            ptsEat = 0;
            lvl += 1;
            x = 140;
            y = HauteurPlateau + 235;
            haut = true;
            right = false;
            left = false;
            bas = false;
            movehaut = true;
            moveright = false;
            moveleft = false;
            movebas = false;
            for (var i = 0; i < 28; i++) {
                for (var j = 0; j < 31; j++) {
                    l[j][i] = tab[j][i];
                }
            }
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPacman();
            drawMap();
            drawinfo();
            if (fruit)
                drawFruit();
            moveFantomes();
        }
        function choix(name) {
            if (name == "blinky")

                var cible = [];
            switch (name) {
                case "blinky":
                    cible = [x, y - HauteurPlateau];
                    break;
                case "pinky":
                    cible = [x, y - HauteurPlateau];
                    if (moveleft) cible[0] -= 40;
                    else if (moveright) cible[0] += 40;
                    else if (movehaut) cible[1] -= 40;
                    else if (movebas) cible[1] += 40;
                    //console.log(cible[0],cible[1])
                    break;
                case "inky":
                    cible = [x, y - HauteurPlateau];
                    if (moveleft) cible[0] -= 20;
                    else if (moveright) cible[0] += 20;
                    else if (movehaut) cible[1] -= 20;
                    else if (movebas) cible[1] += 20;
                    //console.log(cible[0],cible[1])
                    cible[0] += (Math.floor(cible[0] - fantome.blinky.x))
                    cible[1] += (Math.floor(cible[1]) - fantome.blinky.y)
                    //console.log(cible[0],cible[1])
                    break;
                case "clyde":
                    cible = [x, y - HauteurPlateau];
                    break;
            }
            var max = 2000;
            var dir = "nop"
            var distanceD = Math.abs(Math.floor(fantome[name].x + 10) - cible[0]) + Math.abs(Math.floor(fantome[name].y) - cible[1]);
            var distanceG = Math.abs(Math.floor(fantome[name].x - 10) - cible[0]) + Math.abs(Math.floor(fantome[name].y) - cible[1]);
            var distanceH = Math.abs(Math.floor(fantome[name].x) - cible[0]) + Math.abs(Math.floor(fantome[name].y - 10) - cible[1]);
            var distanceB = Math.abs(Math.floor(fantome[name].x) - cible[0]) + Math.abs(Math.floor(fantome[name].y + 10) - cible[1]);

            //console.log(f + " " + fantome[f].direction + " " + tab[Math.floor(Math.round((fantome[name].y) + 5) / 10)][Math.floor(Math.round((fantome[name].x) + 5) / 10)] + " " + Math.floor(Math.round((fantome[name].y))) % 10)
            if (distanceD <= max && fantome[name].direction != "gauche" && tab[Math.floor((Math.round(fantome[name].y)) / 10)][Math.floor(Math.round(fantome[name].x + 5) / 10)] != "3" && Math.floor(Math.round((fantome[name].y))) % 10 == 5) {

                dir = "droite";
                max = distanceD
                // console.log(" choix droit " + fantome[name].direction + " " + max)
            }
            if (distanceH <= max && fantome[name].direction != "bas" && tab[Math.floor((Math.round(fantome[name].y) - 6) / 10)][Math.floor(Math.round(fantome[name].x) / 10)] != "3" && Math.floor(Math.round((fantome[name].y))) % 10 == 5) {

                dir = "haut";
                max = distanceH;
                // console.log(" choix haut " + fantome[name].direction + " " + max)
            }
            if (distanceG <= max && fantome[name].direction != "droite" && tab[Math.floor((Math.round(fantome[name].y)) / 10)][Math.floor((Math.round(fantome[name].x) - 6) / 10)] != "3" && Math.floor(Math.round((fantome[name].x))) % 10 == 5) {

                dir = "gauche";
                max = distanceG;
                //console.log(" choix gauche " + fantome[name].direction + " " + max)
            }
            if (distanceB <= max && fantome[name].direction != "haut" && tab[Math.floor((Math.round(fantome[name].y) + 5) / 10)][Math.floor(Math.round(fantome[name].x) / 10)] != "3" && Math.floor(Math.round((fantome[name].x))) % 10 == 5) {

                dir = "bas";
                max = distanceB;
                //  console.log(" choix bas " + fantome[name].direction + " " + max)
            }

            fantome[name].direction = dir;



        }
        function moveFantomes() {

            for (f in fantome) {

                switch (fantome[f].direction) {
                    case "null":

                        break;
                    case "gauche":

                        if (tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome[f].x) - 6) / 10)] != "3" && Math.floor(Math.round((fantome[f].y))) % 10 == 5) {
                            fantome[f].x -= fantome[f].vitesse;
                            if ((tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome[f].x)) / 10)] == "4" || tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome.blinky.x)) / 10)] == "5") && Math.floor(Math.round((fantome[f].x))) % 10 == 5)
                                choix(f)
                        } else
                            choix(f);
                        break;
                    case "droite":
                        if (tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor(Math.round(fantome[f].x + 5) / 10)] != "3" && Math.floor(Math.round((fantome[f].y))) % 10 == 5) {
                            fantome[f].x += fantome[f].vitesse;
                            if ((tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome[f].x)) / 10)] == "4" || tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome.blinky.x)) / 10)] == "5") && Math.floor(Math.round((fantome[f].x))) % 10 == 5)
                                choix(f)
                        } else
                            choix(f);
                        break;
                    case "haut":
                        if (tab[Math.floor((Math.round(fantome[f].y) - 6) / 10)][Math.floor(Math.round(fantome[f].x) / 10)] != "3" && Math.floor(Math.round((fantome[f].x))) % 10 == 5) {
                            fantome[f].y -= fantome[f].vitesse;
                            if ((tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome[f].x)) / 10)] == "4" || tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome.blinky.x)) / 10)] == "5") && Math.floor(Math.round((fantome[f].y))) % 10 == 5)
                                choix(f)
                        } else
                            choix(f);
                        break;
                    case "bas":
                        if (tab[Math.floor((Math.round(fantome[f].y) + 5) / 10)][Math.floor(Math.round(fantome[f].x) / 10)] != "3" && Math.floor(Math.round((fantome[f].x))) % 10 == 5) {
                            fantome[f].y += fantome[f].vitesse;
                            if ((tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome[f].x)) / 10)] == "4" || tab[Math.floor((Math.round(fantome[f].y)) / 10)][Math.floor((Math.round(fantome.blinky.x)) / 10)] == "5") && Math.floor(Math.round((fantome[f].y))) % 10 == 5)
                                choix(f)
                        } else
                            choix(f);
                        break;
                }
            }
            if (fantome.blinky.x < 0)
                fantome.blinky.x = 280;
            if (fantome.blinky.x > 280)
                fantome.blinky.x = 0;
            drawFantome("#FF0000", fantome.blinky.x, fantome.blinky.y)
            if (fantome.pinky.x < 0)
                fantome.pinky.x = 280;
            if (fantome.pinky.x > 280)
                fantome.pinky.x = 0;
            drawFantome("#FF00FF", fantome.pinky.x, fantome.pinky.y)
            if (fantome.inky.x < 0)
                fantome.inky.x = 280;
            if (fantome.inky.x > 280)
                fantome.inky.x = 0;
            drawFantome("#00FFFF", fantome.inky.x, fantome.inky.y)
            if (fantome.clyde.x < 0)
                fantome.clyde.x = 280;
            if (fantome.clyde.x > 280)
                fantome.clyde.x = 0;
            drawFantome("#FF9900", Math.round((y - 100) / 10), Math.round((fantome.blinky.y) / 10))

            if (Math.round((y - 100) / 10) == Math.round((fantome.blinky.y) / 10) && Math.round((x) / 10) == Math.round((fantome.blinky.x) / 10))
                repositionne()
            if (Math.round((y - 100) / 10) == Math.round((fantome.pinky.y) / 10) && Math.round((x) / 10) == Math.round((fantome.pinky.x) / 10))
                repositionne()
            if (Math.round((y - 100) / 10) == Math.round((fantome.inky.y) / 10) && Math.round((x) / 10) == Math.round((fantome.inky.x) / 10))
                repositionne()
            if (Math.round((y - 100) / 10) == Math.round((fantome.clyde.y) / 10) && Math.round((x) / 10) == Math.round((fantome.clyde.x) / 10))
                repositionne()

        }
        function repositionne() {
            console.log("coliision")
            x = 140;
            y = HauteurPlateau + 235;
            life--;
            left = false; right = false; haut = false, bas = false, moveleft = false; moveright = false; movehaut = false, movebas = false
            if (life == 0)
                GameOver();
        }
        function GameOver() {
            console.log("GameOver")
            restart();
        }
        function restart() {

        }
        function drawFantome(couleur, x, y) {
            ctx.beginPath();
            ctx.arc(x, HauteurPlateau + y, 7, 0, Math.PI * 2);
            ctx.fillStyle = couleur;
            ctx.fill();
            ctx.closePath();

        }
        function drawFruit() {
            ctx.beginPath();
            ctx.arc(140, HauteurPlateau + 175, 7, 0, Math.PI * 2);
            ctx.fillStyle = "#cd5757";
            ctx.fill();
            ctx.closePath();
        }
        document.addEventListener("keydown", keyDownHandler, false);
        function keyDownHandler(e) {
            if (e.key == "d") {
                right = true;
                if (left)
                    left = false;
            }
            else if (e.key == "q" || e.key == "a") {
                left = true;
                if (right)
                    right = false;
            }
            else if (e.key == "z" || e.key == "w") {
                haut = true;
                if (bas)
                    bas = false;
            }
            else if (e.key == "s") {
                bas = true;
                if (haut)
                    haut = false;
            }
        }
        setInterval(draw, 10);
    </script>

</body>

</html>